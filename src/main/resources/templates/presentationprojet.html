<!DOCTYPE html >
<html class="ink">
<head>
<title>CityAct | Présentation proposition d'aménagement </title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
	integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
	integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
	crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="css/css_presentationprojet.css" th:href="@{/css/css_presentationprojet.css}">
<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script> -->
<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->
</head>
<!-- Not connected -->
<div th:if="${session.user == null}">
	<div th:insert="~{CityAct::notConnectedNavbar}"></div>
</div>
<!-- Connected -->
<div th:if="${session.user != null}">
	<div th:insert="~{CityActConnectNavbar::connectedNavbar}"></div>
</div>

 <div class="nav-gap"></div>
 
   <div id="bread" class="container-fluid" >
 <ul class="breadcrumb">
  <li><a id="bc" href="map" >Carte</a></li>
   <li class="active">Présentation proposition d'aménagement</li>
</ul>
</div>

<div id="mapform" class="container-fluid">
<div class="row">

<div class="col-md-6">

<form th:object="${projet}"id="formAB" method="GET" >


<h5 id="ABtitre">-Projet d'aménagement-</h5>

   <div class="form-row" > 
   <div class="form-group col-md-8" >
      <label for="inputTSAB"><b>Référence ambient power</b></label>
      <input type="text" class="form-control" id="Idplanningproposal" disabled th:value="*{id}">
    </div>
    <div class="form-group col-md-8" >
      <label for="inputTSAB"><b>Date du dépôt du constat</b></label>
      <input type="text" class="form-control" id="Datedudépôt" disabled th:value="*{datecreation}">
    </div>
    </div>
    
   <div class="form-group col-md-auto" >
      <label for="inputTSAB"><b>Titre projet d'aménagement</b></label>
      <input type="text" class="form-control" id="Titre signalement" disabled th:value="*{titre}">
    </div>
    
    <div class="form-group col-md-auto" >
      <label for="inputTSAB"><b>Temporalité</b></label>
      <input class="form-control" id="Temporalité" disabled th:value="*{temporalite}">
    
    </div>
  
      <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Descriptif du projet</b></label>
      <input class="form-control" id="Descriptif"  rows="3" disabled th:value="*{descriptif}"></input>
    </div>
    
 <div class="form-row photos" > 
    <div class="form-group col-md-auto"></div>
 </div>

<!--   <div class="form-group col-md-auto"> -->
<!--       <label for="inputTSAB"><b>Inspirations | Benchmarking - Parangonnage</b></label> -->
<!--        <input class="form-control" id="benchmark"   disabled th:value="*{benchmark}"></input> -->
      
<!--     </div> -->
    
    <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Nombre de vote pour le projet</b></label>
       <input class="form-control" id="votepos"  disabled th:value="*{votepos}"></input>
          </div>
 
    <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Nombre de vote contre le projet</b></label>
       <input class="form-control" id="voteneg"  disabled th:value="*{voteneg}"></input>
          </div>
  
<!-- <div class="form-group col-md-auto"> -->
<!-- <label for="fileupload"><b>Choisissez une photo à ajouter</b></label> -->
<!-- <input type="file" name="fileupload" value="fileupload" id="fileupload2" required> -->
<!-- </div> -->

<!-- <div class="form-group col-md-auto"> -->
<!-- <label for="fileupload"><b>Choisissez une photo à ajouter</b></label> -->
<!-- <input type="file" name="fileupload" value="fileupload" id="fileupload2" required> -->
<!-- </div> -->


</form>

</div> 
<!-- end of col-md-6 -->



<div class="col-md-6" id="map"></div>

</div>
<!-- end row-md-6 -->
<script  th:inline="javascript">
						var map, infoWindow, pos;

						function CenterControl(controlDiv, map) {

							// Set CSS for the control border.
							var controlUI = document.createElement('div');
							controlUI.style.backgroundColor = '#fff';
							controlUI.style.border = '2px solid #fff';
							controlUI.style.borderRadius = '3px';
							controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
							controlUI.style.cursor = 'pointer';
							controlUI.style.marginBottom = '22px';
							controlUI.style.textAlign = 'center';
							controlUI.title = 'Click to recenter the map';
							controlDiv.appendChild(controlUI);

							// Set CSS for the control interior.
							var controlText = document.createElement('div');
							controlText.style.color = 'rgb(25,25,25)';
							controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
							controlText.style.fontSize = '16px';
							controlText.style.lineHeight = '38px';
							controlText.style.paddingLeft = '5px';
							controlText.style.paddingRight = '5px';
							controlText.innerHTML = 'Center Map';
							controlUI.appendChild(controlText);

							// Setup the click event listeners: simply set the map to Chicago.
							controlUI.addEventListener('click', function() {
								map.setCenter(pos);
							});

						}

						/* 					 // Create the search box and link it to the UI element.
						 var input = document.getElementById('pac-input');
						 var searchBox = new google.maps.places.SearchBox(input);
						
						 // Bias the SearchBox results towards current map's viewport.
						 map.addListener('bounds_changed', function() {
						 searchBox.setBounds(map.getBounds());
						 }); */

						function initMap() {
							map = new google.maps.Map(document
									.getElementById('map'), {
								center : {
									lat : -34.397,
									lng : 150.644
								},
								zoom : 14
							});
							infoWindow = new google.maps.InfoWindow;

							// Try HTML5 geolocation.
							if (navigator.geolocation) {
								navigator.geolocation
										.getCurrentPosition(
												function(position) {
													pos = {
														lat : position.coords.latitude,
														lng : position.coords.longitude
													};

													var marker_mapos = new google.maps.Marker({
														position: pos,
														title:"Vous êtes ici",
														icon:"http://maps.google.com/mapfiles/kml/shapes/placemark_circle.png"
													})
													marker_mapos.setMap(map);
													
												}, function() {
													handleLocationError(true,
															infoWindow,
															map.getCenter());
												});
							} else {
								// Browser doesn't support Geolocation
								handleLocationError(false, infoWindow, map
										.getCenter());
							}
							
							/*<![CDATA[*/
							var latitude = /*[[${projet.latitude}]]*/
							var longitude = /*[[${projet.longitude}]]*/
							marker_project = new google.maps.Marker({
						         position: new google.maps.LatLng(latitude, longitude),
						         map: map
						});
							var icon = {
								    url: "http://maps.google.com/mapfiles/kml/paddle/grn-blank.png", // url
								    scaledSize: new google.maps.Size(40, 40), // scaled size
								};
							marker_project.setIcon(icon);
							map.setCenter(marker_project.position);
							
							/*]]>*/

							// Create the DIV to hold the control and call the CenterControl()
							// constructor passing in this DIV.
							var centerControlDiv = document
									.createElement('div');
							var centerControl = new CenterControl(
									centerControlDiv, map);

							centerControlDiv.index = 1;
							map.controls[google.maps.ControlPosition.TOP_CENTER]
									.push(centerControlDiv);
						}

						function handleLocationError(browserHasGeolocation,
								infoWindow, pos) {
							infoWindow.setPosition(pos);
							infoWindow
									.setContent(browserHasGeolocation ? 'Error: The Geolocation service failed.'
											: 'Error: Your browser doesn\'t support geolocation.');
							infoWindow.open(map);
						}
					</script>

					<script>
						/*  Script qui va permettre d'éviter que les dropdown se ferment à chaque clics à côtés */
						$(document).on('click', '.dropup', function(e) {
							e.stopPropagation();
						});
					</script>

</div>

<div id="postcommentvote" class="container-fluid" >
<div class="row">
<div class="col-md-3">

<button class="btn-yes" type="submit" onclick="voted()" onsubmit="disable()">
<span id="voteyes"class="far fa-check-circle fa-6x"></span></button>
<a class="votepro"><b>Vote favorable au projet</b></a><p class="idstyle" id="àvoté"></p>
</div>

<div class="col-md-3">
<button class="btn-no" type="submit" onclick="contrevote()" onsubmit="disable()">
<span id="voteno"class="far fa-times-circle fa-6x"></span> </button>
<a class="votepro"><b>Vote défavorable au projet</b></a> <p class="idstyle1" id="contrevote"></p>
</div>


<script> function voted() { 
	document.getElementById("àvoté").innerHTML = "Votre vote à été pris en compte";}
	
	function contrevote() {
	document.getElementById("contrevote").innerHTML = "Votre avis à été pris en compte";
	}</script>

<script> function disable() { var btn = document.getElementById('btn-yes');
btn.disabled = true;}</script>



<div class="col-md-6">
<form th:object="${projet}" th:action="'/goto_projet_presentation/'+ ${projet.id} +'/formap_post_comment'" method="POST">
 <div class="form-group">
  <label for="comment"><b>Commenter le projet </b></label>
  <textarea class="form-control " rows="5" id="comment" name="comment_text"></textarea>
   <button id="publibtn" class="btn btn-success" type="submit">Publier mon commentaire</button>
  </div>
    </form>
  </div>
 
</div> </div>


<h4 id="hcom"> Commentaires</h4>
<hr class="pg-titl-bdr-btm">


	<div class="media border -3" th:each="comment: ${comments}">
	<img src="/pictures/iconfinder_JD-18_2246807.png" alt="John Doe" class="align-self-start mr-3  rounded-circle" style="width:60px;">
	<div class="media-body">
	<h4><span th:utext='${comment.users.pseudo}'></span><small><i>Posted on <span th:utext="${comment.date}"></span></i></small></h4>
    <p th:utext='${comment.text}'></p>
	</div>
	</div>






<div class="footer-gap"></div>
<div th:insert="~{footer::footer}"></div>


<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDXFTORjfXpPSkt7ZEuotSXE4UtvZk0T8&callback=initMap"
async defer></script>
 </html>