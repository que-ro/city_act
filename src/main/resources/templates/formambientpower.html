<!DOCTYPE html >
<html class="ink">
<head>
<title>CityAct | Formulaire Ambient Power</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
	integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
	integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
	crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="css/css_formambientpower.css">
<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script> -->
<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->
</head>
 
<div th:insert="~{CityActConnectNavbar::connectedNavbar}"></div>
 <div class="nav-gap"></div>
 
 <div id="bread" class="container-fluid" >
 <ul class="breadcrumb">
  <li><a id="bc" href="/map" >Carte</a></li>
  <li><a >Ajouter un marqueur</a></li>
   <li class="active">Formulaire Ambient Power</li>
</ul>
</div>

<div id="DescriptifAB" class="container-fluid">
<h5 id="dab"><b>Descriptif du formulaire Ambient Power</b></h5>
<br>
<a> L'ambient power est un concept mis en exergue par John Allen. La base de ce concept est que l'environnement bâti dans lequel nous évoluons 
à une influencee sur la manière de vivre un espace public de s'y sentir, de s'y comporter et donc de s'y conformer. Cette idéologie peut être réinterprété et outillée de manière à déterminer
 quelles sont les composantes qui participe a créer cette atmosphère spécifique et donc ainsi agir sur notre environnement pour proposer des services et générer un espace publique, une ville plus agréable. 
 Et c'est ici que vous citoyens, résidents, consommateurs fréquents  vous jouez un rôle! Votre expertise, votre connaissance quotidienne du lieu  sont essentielles pour nous architectes, urbanistes, géographes, sociologues, politiciens. Nous qui travaillons pour vous offrir une ville où il fait bon vivre mais que nous ne pratiquons pas toujours de manière quotidienne, que nous percevons différemment. Anisi dans cet espace Ambient Power nous vous invitons à vous exprimer, à recenser les espaces qui peuvent être améliorés, qui présente une atmosphère specifique qui vous fait 
 ressentir quelque chose de négatif et qui pourrait être amélioré. Juste un point pour nous informer nous professionnel de l'aménagment du territoire et nous permettrait à l'avenir de peut etre concentrer nos etudes sur ces espaces-ci. Nous vous offrons également la possibilité d'exprimer des idées d'améliorations le cas échéant. 
 dvper la diff avec le formulaire projets d'aménagements [...]  </a> 
 </div>

<div id="mapform" class="container-fluid">
<div class="row">

<div class="col-md-6">

<form id="formAB" th:object="${ambientPower}" action="/ambientpowerform_method" method="POST" enctype="multipart/form-data">

<h5 id="ABtitre">-Ambient Power-</h5>

<div class="col-md-auto form-group">
			<input id="autocomplete"
             placeholder="Entrez votre adresse pour compléter automatiquement les champs"
             onFocus="geolocate()"
             type="text"
             class="form-control"/>
	</div>

<!-- inputs qui vont être pré remplies automatiquement par le javascript -->
	<input type="hidden" id="inputLatitude" value="" th:field="*{latitude}"/>
	<input type="hidden" id="inputLongitude" value="" th:field="*{longitude}"/>

<div class="form-row" >
	
        <div class="form-group col-md-1">
    <label for="inputNumero"><b>N°</b></label>
    <input type="text" class="form-control" id="street_number" disabled>
  </div>
  
<div class="form-group col-md-3">
	<label for="inputAddress"><b>Adresse</b></label>
    <input type="text" class="form-control" id="route"  disabled>
</div>


  <div class="form-group col-md-2" >
      <label for="inputZip"><b>Code Postal</b></label>
      <input type="text" class="form-control" id="postal_code" disabled>
    </div>
<!--     </div> -->
    <div class="form-group col-md-2">
      <label for="inputCity"><b>Ville</b></label>
      <input type="text" class="form-control" id="locality" disabled>
    </div>
    
<!--   <div class="form-row"> -->
    <div class="form-group col-md-2">
      <label for="inputRegion"><b>Région</b></label>
      <input type="text" class="form-control" id="administrative_area_level_1" disabled>
    </div>
    
    <div class="form-group col-md-2" style="padding-right:2%">
      <label for="inputState"><b>Pays</b></label>
      <input type="text" id="country" class="form-control" disabled>
           </div>
           
    
  </div>
  
   <div class="form-group col-md-auto" >
      <label for="inputTSAB"><b>Titre signalement</b></label>
      <input type="text" class="form-control" id="Titre signalement" th:field="*{titre}" required>
    </div>
  
  
  <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Descriptif</b></label>
      <textarea class="form-control" id="Descriptif"  rows="3" th:field="*{descriptif}" required></textarea>
    </div>
 
 <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Intensité du ressenti négatif (de 1 à 10)</b></label>
      <select type="text" id="inputTSAB" class="custom-select my-1 mr-sm-2" placeholder="Une valeur de 1 à 10" th:field="*{intensiteressentie}" required>
      <option id="op" th:value="'1'" th:text="1"></option>
    <option id="op" th:value="'2'" th:text="2"></option>
    <option id="op" th:value="'3'" th:text="3"></option>
    <option id="opo" th:value="'4'" th:text="4"></option>
    <option id="opo" th:value="'5'" th:text="5"></option>
    <option id="opo" th:value="'6'" th:text="6"></option>
    <option id="opo" th:value="'7'" th:text="7"></option>
     <option id="opr" th:value="'8'" th:text="8"></option>
      <option id="opr" th:value="'9'" th:text="9"></option>
       <option id="opr" th:value="'10'" th:text="10"></option>
    
    </select>
      <span th:if="${#fields.hasErrors('intensiteressentie')}" th:errors="*{intensiteressentie}" class="span_error_modifcompte">NameError</span>
    </div>
  
  <div class="form-group col-md-auto">
      <label for="inputTSAB"><b>Idées d'améliorations?</b></label>
       <textarea class="form-control" id="Idées d'améliorations" th:field="*{ideeamelioration}" rows="3"></textarea>
      
    </div>
 
  
<div class="form-group col-md-auto">
<label for="fileupload"><b>Choisissez une photo à ajouter</b></label>
<input type="file" name="picture" value="fileupload" id="fileupload2">
</div>

<div class="form-group offset-md-9 col-md-3">
<button id="ABbtn" class="btn btn-primary " type="submit">Soumettre le formulaire </button>
	</div>

</form>

    

</div> 
<!-- end of col-md-6 -->



<div class="col-md-6" id="map"></div>

</div>
<!-- end row-md-6 -->
<script th:inline="javascript">
function initialize() {
	  initMap();
	  initAutocomplete();
	}
	var map, marker, infoWindow;

	function initMap() {
	    map = new google.maps.Map(document.getElementById('map'), {
	      center: {
	        lat: -34.397,
	        lng: 150.644
	      },
	      zoom: 14
	    });
	    infoWindow = new google.maps.InfoWindow;

        // Try HTML5 geolocation.
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            var pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            infoWindow.setPosition(pos);
            infoWindow.setContent('Vous êtes ici.');
            infoWindow.open(map);
            map.setCenter(pos);
          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }
      }

      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
      }
	  
	  // This example displays an address form, using the autocomplete feature
	  // of the Google Places API to help users fill in the information.

	// This example requires the Places library. Include the libraries=places
	// parameter when you first load the API. For example:
	// <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

	var placeSearch, autocomplete;
	var componentForm = {
	  street_number: 'short_name',
	  route: 'long_name',
	  locality: 'long_name',
	  administrative_area_level_1: 'short_name',
	  country: 'long_name',
	  postal_code: 'short_name'
	};

	function initAutocomplete() {
	  // Create the autocomplete object, restricting the search to geographical
	  // location types.
	  autocomplete = new google.maps.places.Autocomplete(
	    /** @type {!HTMLInputElement} */
	    (document.getElementById('autocomplete')), {
	      types: ['geocode']
	    });

	  // When the user selects an address from the dropdown, populate the address
	  // fields in the form.
	  autocomplete.addListener('place_changed', fillInAddress);
	}

	function fillInAddress() {
	  // Get the place details from the autocomplete object.
	  var place = autocomplete.getPlace();
	  console.log('the latitude is : ' + place.geometry.location.lat());
	  console.log('the longitude is : ' + place.geometry.location.lng());
	  
	  document.getElementById('inputLatitude').value = place.geometry.location.lat()
	  document.getElementById('inputLongitude').value = place.geometry.location.lng()

	  if (place.geometry.viewport) {
	    map.fitBounds(place.geometry.viewport);
	  } else {
	    map.setCenter(place.geometry.location);
	    map.setZoom(16); // Why 17? Because it looks good.
	  }
	  if (!marker) {
	    marker = new google.maps.Marker({
	      map: map,
	      anchorPoint: new google.maps.Point(0, -29)
	    });
	  } else marker.setMap(null);
	  marker.setOptions({
	    position: place.geometry.location,
	    map: map
	  });

	  for (var component in componentForm) {
	    document.getElementById(component).value = '';
	    document.getElementById(component).disabled = false;
	  }

	  // Get each component of the address from the place details
	  // and fill the corresponding field on the form.
	  for (var i = 0; i < place.address_components.length; i++) {
	    var addressType = place.address_components[i].types[0];
	    if (componentForm[addressType]) {
	      var val = place.address_components[i][componentForm[addressType]];
	      document.getElementById(addressType).value = val;
	    }
	  }
	}

	// Bias the autocomplete object to the user's geographical location,
	// as supplied by the browser's 'navigator.geolocation' object.
	function geolocate() {
	  if (navigator.geolocation) {
	    navigator.geolocation.getCurrentPosition(function(position) {
	      var geolocation = {
	        lat: position.coords.latitude,
	        lng: position.coords.longitude
	      };
	      var circle = new google.maps.Circle({
	        center: geolocation,
	        radius: position.coords.accuracy
	      });
	      autocomplete.setBounds(circle.getBounds());
	    });
	  }
	}

</script>
	</script>
					
					
					
					<script>

    </script>

</div>



 <div class="footer-gap"></div>
<div th:insert="~{footer::footer}"></div>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDXFTORjfXpPSkt7ZEuotSXE4UtvZk0T8&libraries=places&callback=initialize"
        async defer></script>

 </html>
